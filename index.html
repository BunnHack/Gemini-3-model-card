<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Roblox Studio UI (Web)</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/react-complex-tree/lib/style.css" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://unpkg.com/codemirror@5.65.16/lib/codemirror.css" />
  <link rel="stylesheet" href="https://unpkg.com/codemirror@5.65.16/theme/dracula.css" />
  <script type="importmap">
  {
    "imports": {
      "split.js": "https://esm.sh/split.js@1.6.5",
      "three": "https://esm.sh/three@0.164.1",
      "three/addons/": "https://esm.sh/three@0.164.1/examples/jsm/",
      "react": "https://esm.sh/react@18.2.0?dev",
      "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime?dev",
      "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?dev",
      "react-complex-tree": "https://esm.sh/react-complex-tree@2.3.2?external=react,react-dom",
      "lucide-react": "https://esm.sh/lucide-react@0.468.0?external=react",
      "@babel/standalone": "https://esm.sh/@babel/standalone@7.24.0",
      "lil-gui": "https://esm.sh/lil-gui@0.19.1"
    }
  }
  </script>
  <script src="https://unpkg.com/codemirror@5.65.16/lib/codemirror.js"></script>
  <script src="https://unpkg.com/codemirror@5.65.16/mode/javascript/javascript.js"></script>
  <script src="https://unpkg.com/codemirror@5.65.16/addon/edit/closebrackets.js"></script>
  <script src="https://unpkg.com/codemirror@5.65.16/addon/edit/matchbrackets.js"></script>
  <script src="https://unpkg.com/codemirror@5.65.16/addon/selection/active-line.js"></script>
</head>
<body>
  <header class="ribbon">
    <div class="title-bar">
      <div class="quick-access">
        <button class="qa-btn" title="Save">ğŸ’¾</button>
        <button class="qa-btn" title="Undo">â†©ï¸</button>
        <button class="qa-btn" title="Redo">â†ªï¸</button>
      </div>
      <div class="window-title">Place1 - Roblox Studio</div>
      <div class="user-auth">User</div>
    </div>
    <div class="ribbon-tabs">
      <button class="tab file-tab">FILE</button>
      <button class="tab active" data-tab="Home">Home</button>
      <button class="tab" data-tab="Model">Model</button>
      <button class="tab" data-tab="Avatar">Avatar</button>
      <button class="tab" data-tab="Test">Test</button>
      <button class="tab" data-tab="View">View</button>
      <button class="tab" data-tab="Plugins">Plugins</button>
    </div>
    <div class="ribbon-bar">
      <div class="ribbon-page active" data-tab="Home">
        <div class="group">
            <div class="group-col">
                <button class="tool-btn small"><span class="icon">ğŸ“‹</span></button>
                <button class="tool-btn small"><span class="icon">âœ‚ï¸</span></button>
            </div>
            <span class="group-label">Clipboard</span>
        </div>
        <div class="group">
            <button id="tool-select" class="tool-btn active large">
                <span class="icon">â†–ï¸</span>
                <span class="label">Select</span>
            </button>
            <button id="tool-move" class="tool-btn large">
                <span class="icon">â†”ï¸</span>
                <span class="label">Move</span>
            </button>
            <button id="tool-scale" class="tool-btn large">
                <span class="icon">â¤¢</span>
                <span class="label">Scale</span>
            </button>
            <button id="tool-rotate" class="tool-btn large">
                <span class="icon">â†»</span>
                <span class="label">Rotate</span>
            </button>
            <span class="group-label">Tools</span>
        </div>
        <div class="group">
             <button class="tool-btn large">
                <span class="icon">ğŸ§±</span>
                <span class="label">Editor</span>
            </button>
            <button class="tool-btn large">
                <span class="icon">ğŸ§°</span>
                <span class="label">Toolbox</span>
            </button>
            <span class="group-label">Terrain</span>
        </div>
        <div class="group">
            <div class="group-col">
               <button id="load-rbxlx-button" class="tool-btn wide"><span class="icon">ğŸ“‚</span> Load .rbxlx</button>
               <div style="display: flex; gap: 2px; width: 100%;">
                   <button id="export-rbxlx" class="tool-btn wide" style="flex: 1;" title="Export XML"><span class="icon">ğŸ“„</span> .rbxlx</button>
                   <button id="export-rbxl" class="tool-btn wide" style="flex: 1;" title="Export Binary"><span class="icon">ğŸ’¾</span> .rbxl</button>
               </div>
               <button id="publish-roblox" class="tool-btn wide"><span class="icon">â˜ï¸</span> Publish to Roblox</button>
            </div>
            <span class="group-label">Settings</span>
        </div>
      </div>
      <div class="ribbon-page" data-tab="Model">
        <div class="group">
          <div class="dropdown">
            <button class="tool-btn large dropdown-toggle">
                <span class="icon">ğŸ’</span>
                <span class="label">Part â–¼</span>
            </button>
            <div class="dropdown-content">
              <button id="create-part" class="dropdown-item">Block</button>
              <button id="create-sphere" class="dropdown-item">Sphere</button>
              <button id="create-cylinder" class="dropdown-item">Cylinder</button>
              <button id="create-wedge" class="dropdown-item">Wedge</button>
            </div>
          </div>
          <button id="create-spawnlocation" class="tool-btn large">
            <span class="icon">Spawn</span>
            <span class="label">Spawn</span>
          </button>
          <span class="group-label">Parts</span>
        </div>
        <div class="group">
            <button class="tool-btn large"><span class="icon">ğŸ”—</span><span class="label">Union</span></button>
            <button class="tool-btn large"><span class="icon">ğŸ’”</span><span class="label">Negate</span></button>
            <button class="tool-btn large"><span class="icon">â›“ï¸</span><span class="label">Separate</span></button>
            <span class="group-label">Solid Modeling</span>
        </div>
      </div>
      <div class="ribbon-page" data-tab="Avatar"><div class="group"><span class="group-label">Avatar</span><button class="tool-btn large"><span class="label">Rig Builder</span></button></div></div>
      <div class="ribbon-page" data-tab="Test">
          <div class="group">
              <button class="tool-btn large"><span class="icon">â–¶ï¸</span><span class="label">Play</span></button>
              <button class="tool-btn large"><span class="icon">â¸ï¸</span><span class="label">Pause</span></button>
              <button class="tool-btn large"><span class="icon">â¹ï¸</span><span class="label">Stop</span></button>
              <span class="group-label">Simulation</span>
          </div>
      </div>
      <div class="ribbon-page" data-tab="View">
          <div class="group">
              <label class="toggle tool-btn wide"><input type="checkbox" data-panel="explorer" checked> <span class="icon">ğŸ—‚ï¸</span> Explorer</label>
              <label class="toggle tool-btn wide"><input type="checkbox" data-panel="properties" checked> <span class="icon">ğŸ“</span> Properties</label>
              <label class="toggle tool-btn wide"><input type="checkbox" data-panel="output" checked> <span class="icon">ğŸ“Ÿ</span> Output</label>
              <span class="group-label">Windows</span>
          </div>
      </div>
      <div class="ribbon-page" data-tab="Plugins"><div class="group"><span class="group-label">Plugins</span><button class="tool-btn large">Manage Plugins</button></div></div>
    </div>
  </header>

  <main id="workspace">
    <div id="columns" class="gutter-parent">
      <section id="center-col" class="column">
        <div id="center-split" class="gutter-parent vertical">
          <div id="viewport" class="panel viewport">
            <div class="panel-header">
              <span>Place1</span>
            </div>
            <div class="panel-body view">
              <div id="script-editor" class="script-editor" style="display:none;">
                <div class="editor-header">
                  <span id="script-title">Script</span>
                  <div class="panel-actions"><button id="close-editor" class="btn small">Close</button></div>
                </div>
                <div id="cm-host" class="editor-host"></div>
              </div>
            </div>
          </div>

          <div id="output" class="panel">
            <div class="panel-header">
              <span>Output</span>
              <div class="panel-actions">
                <button id="clear-output" class="btn small">Clear</button>
              </div>
            </div>
            <div id="console" class="panel-body console"></div>
          </div>
        </div>
      </section>

      <section id="right-col" class="column">
        <div id="right-split" class="gutter-parent vertical">
            <div id="explorer" class="panel">
            <div class="panel-header">
                <span>Explorer</span>
                <div class="panel-actions">
                    <input type="text" placeholder="Search..." class="panel-search">
                </div>
            </div>
            <div id="explorer-root" class="panel-body">
                <!-- React-complex-tree will render here -->
            </div>
            </div>

            <div id="properties" class="panel">
            <div class="panel-header">
                <span>Properties</span>
            </div>
            <div id="properties-container" class="panel-body">
                <!-- lil-gui will be mounted here -->
            </div>
            </div>
        </div>
      </section>
    </div>
  </main>

  <div id="publish-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Publish Place to Roblox</h3>
        <button id="publish-modal-close" class="close-button">&times;</button>
      </div>
      <div class="modal-body">
        <p>Enter your API Key and IDs to publish your place. This will send data to a proxy server for processing.</p>
        <div class="form-group">
            <label>Publish Source</label>
            <div class="publish-source-options">
              <label><input type="radio" name="publish-source" value="current" checked> Current Scene</label>
              <label><input type="radio" name="publish-source" value="file"> Upload File</label>
            </div>
          </div>
        <div class="form-group" id="publish-file-upload-group" style="display: none;">
            <label for="rbxlx-file-input">RBXLX File</label>
            <input type="file" id="rbxlx-file-input" accept=".rbxlx,.rbxlx.xml">
        </div>
        <div class="form-group">
          <label for="api-key">API Key</label>
          <input type="password" id="api-key" placeholder="Enter your Roblox API Key">
        </div>
        <div class="form-group">
          <label for="universe-id">Universe ID</label>
          <input type="text" id="universe-id" placeholder="e.g., 123456789">
        </div>
        <div class="form-group">
          <label for="place-id">Place ID</label>
          <input type="text" id="place-id" placeholder="e.g., 987654321">
        </div>
        <div class="form-group">
          <label for="version-type">Version Type</label>
          <select id="version-type">
            <option value="Published">Published</option>
            <option value="Saved">Saved</option>
          </select>
        </div>
        <div class="form-group remember-group">
            <input type="checkbox" id="remember-details">
            <label for="remember-details">Remember my details</label>
        </div>
        <div id="publish-status" class="status-message" style="display: none;"></div>
      </div>
      <div class="modal-footer">
        <button id="publish-modal-cancel" class="btn">Cancel</button>
        <button id="publish-modal-submit" class="btn">Publish</button>
      </div>
    </div>
  </div>

  <input type="file" id="rbxlx-file-loader" style="display: none;" accept=".rbxlx,.rbxlx.xml">

  <script type="module" src="main.js"></script>
  <script type="module" src="explorer.js"></script>
</body>
</html>